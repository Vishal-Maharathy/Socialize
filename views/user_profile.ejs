<!DOCTYPE html>
<html>
    <style>
        body{
            margin: 0;
            padding: 0;
            background-color: #00a46d;
            height: 100vh;
        }
        h1{
            font-weight: bolder;
            font-family: sans-serif;
            text-align: center;
            padding: 0;
            margin: 0;
            margin-bottom: 2vh;
        }
        p{
            margin: 0;
            padding: 0;
            text-align: center;
            font-size: larger;
            font-family: sans-serif;
            font-weight: 400;
        }
        #update-form{
            text-align: center;
        }
        #update-form input{
            display: block;
            margin-left: 50%;
            transform: translateX(-50%);
            margin-top: 3vh;
            margin-bottom: 3vh;
            background-color: beige;
            border: none;
            padding: 5px;
            font-family: sans-serif;
            font-size: large;
        }
        #details{
            text-align: center;
        }
    </style>
    <head>
        <title>Profile!</title>
        <link rel="icon" type="image/x-icon" href="/uploads/images/S.png">
        <link rel="stylesheet" href="/css/header.css">
        <link rel="stylesheet" href="/css/home_style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/noty/3.1.4/noty.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    </head>
    <body>
        <%- include('_header') %>
        <div id="details">
            <div>
                <% if(!profile_user.avatar) { %>
                    <img src="/uploads/users/avatars/profilepic.png" alt="profile pic" height="140px" width="140px" style="border-radius: 50%; margin-top: 1vh;">
                <% } else { %>
                    <img src="<%=profile_user.avatar%>" alt="profile pic" height="140px" width="140px" style="border-radius: 50%;">
                <% } %>    
            </div>
            <div>Name: <%=profile_user.name %></div>
            <div>Email: <%=profile_user.email %></div>
        </div>
       <% if(user.id == profile_user.id) { %>
        <!-- show the form for updation of details -->
        <p style="margin-top: 3vh;">Update</p>
        <form action="/users/update/<%= profile_user.id %>" enctype="multipart/form-data" method="post" id="update-form">
            <input type="text" name="name" placeholder="Your Name" value="<%= profile_user.name %>"  required>
            <input type="email" name="email" placeholder="Your E-Mail" value="<%= profile_user.email %>"  required>
            <span>Change/Add Profile Picture: </span><input type="file" name="avatar">
            <input type="submit" value="Update">
            <p><a href="/signout" style="text-decoration: none; color: #00a46d;">Sign Out</a></p>
        </form> 
        <% } %>
        <% if(user.id != profile_user.id && !isFriend && !requestSent){%>
            <a href="/notifications/sendRequest/<%=person_id%>" id="send_request">Send Friend Request</a>
        <% }else{ %>
            <a href="/signin" style="text-decoration: none; color: #00a46d;"></a>
        <%}%>
        
    </body>
    <script>
        <% if (flash.success && flash.success.length > 0) { %>
            new Noty({
                theme: 'sunset',
                text: '<%= flash.success %>',
                type: 'success',
                layout: 'topRight',
                timeout: 1500
            }).show();
        <% } %>
        <% if (flash.error && flash.error.length > 0) { %>
                new Noty({
                    theme: 'sunset',
                    text: '<%= flash.error %>',
                    type: 'error',
                    layout: 'topRight',
                    timeout: 1500
                }).show();
        <% } %>
    </script>
</html>